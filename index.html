<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <title>Games App</title>
</head>
<body>
    <h1 id="judul1">Games App</h1>
    <!-- <div style="background-color: rgb(255, 8, 8);"></div> -->
    <br>
  
    <div id="trivia-list">
        
    </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>
        function showMainPage() {
            fetchTrivia()
        }

        function btnAnswer(options, answer) {
            if (options === answer) {
                Swal.fire(
                    'Correct!',
                    'Good Job Bro!',
                    'success'
                )
            } else {
                Swal.fire(
                    'Incorrect!',
                    'Please try Again!',
                    'error'
                )
            }
        }

        function fetchTrivia() {
            $.ajax({
                url: "http://localhost:3000/triviaAPI",
                method: "GET",

            })
            .done(response => {

                const random = Math.floor(Math.random() * response.length) 
                while(response[random].type == 'boolean') {
                    const random = Math.floor(Math.random() * response.length) 
                }
         
                const temp = [response[random].incorrect_answers[0], response[random].incorrect_answers[1], response[random].incorrect_answers[2], response[random].correct_answer]
                let option1 = Math.floor(Math.random() * temp.length)
                let option2 = Math.floor(Math.random() * temp.length)
                let option3 = Math.floor(Math.random() * temp.length)
                let option4 = Math.floor(Math.random() * temp.length)

    
                while (option2 === option1) {
                    option2 = Math.floor(Math.random() * temp.length)
                }
                while (option3 === option2 || option3 === option1) {
                    option3 = Math.floor(Math.random() * temp.length)
                }
                while (option3 === option4 || option4 === option2 || option4 === option1) {
                    option4 = Math.floor(Math.random() * temp.length)
                }

                    $('#trivia-list').append(`<h1>${response[random].question}</h1>
                    <div class="btn"><button class="answer" onclick="btnAnswer('${temp[option1]}', '${temp[3]}')">${temp[option1]}</button></div>
                    <div class="btn"><button class="answer" onclick="btnAnswer('${temp[option2]}', '${temp[3]}')">${temp[option2]}</button></div>
                    <div class="btn"><button class="answer" onclick="btnAnswer('${temp[option3]}', '${temp[3]}')">${temp[option3]}</button></div>
                    <div class="btn"><button class="answer" onclick="btnAnswer('${temp[option4]}', '${temp[3]}')">${temp[option4]}</button></div>`)

            })
            .fail((xhr, textStatus) => {
                console.log(xhr, textStatus);
            })
            
        }

        $(document).ready(()=> {
            showMainPage()
        })
    </script>
</body>
</html>